<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <!-- polyfill -->
    <script src="midijs/inc/shim/Base64.js" type="text/javascript"></script>
    <script src="midijs/inc/shim/Base64binary.js" type="text/javascript"></script>
    <script src="midijs/inc/shim/WebAudioAPI.js" type="text/javascript"></script>
    <!-- midi.js package -->
    <script src="midijs/js/midi/audioDetect.js" type="text/javascript"></script>
    <script src="midijs/js/midi/gm.js" type="text/javascript"></script>
    <script src="midijs/js/midi/loader.js" type="text/javascript"></script>
    <script src="midijs/js/midi/plugin.audiotag.js" type="text/javascript"></script>
    <script src="midijs/js/midi/plugin.webaudio.js" type="text/javascript"></script>
    <script src="midijs/js/midi/plugin.webmidi.js" type="text/javascript"></script>
    <!--<script src="midijs/js/midi/player.js"></script>-->
    <!-- utils -->
    <script src="midijs/js/util/dom_request_xhr.js" type="text/javascript"></script>
    <script src="midijs/js/util/dom_request_script.js" type="text/javascript"></script>

    <script src="index.js"></script>
    <title>Title</title>
</head>
<body>
<script type="text/javascript">

    window.onload = function () {
        MIDI.loadPlugin({
            soundfontUrl: "midijs/examples/soundfont/",
            instrument: "acoustic_grand_piano",
            onprogress: function (state, progress) {
                console.log(state, progress);
            },
            onsuccess: function () {
                console.log('load success');
                MIDI.setVolume(0, 127);

                // first load
//                playNextTSeconds(4, 0);

                var velocity = 127
//                Playing: pitch = 60 startTime=0 rhythmValue=0.5
//                MIDI.noteOn(0, 60, velocity, 0);
//                MIDI.noteOff(0, 60, 0 + 0.5);
//                (index):45 Playing: pitch = 61 startTime=0.5 rhythmValue=0.5
                MIDI.noteOn(0, 61, velocity, 0.5);
                MIDI.noteOff(0, 61, 1);
//                (index):45 Playing: pitch = 62 startTime=1 rhythmValue=0.5
//                MIDI.noteOn(0, 62, velocity, 1);
//                MIDI.noteOff(0, 62, 1 + 0.5);
//                (index):45 Playing: pitch = 63 startTime=1.5 rhythmValue=0.5
//                MIDI.noteOn(0, 63, velocity, 1.5);
//                MIDI.noteOff(0, 63, 1.5 + 0.5);
            }
        });
    };

    var playNote = function (pitch, velocity, startTime, rhythmValue) {
        console.log("Playing: pitch = " + pitch + " startTime=" + startTime + " rhythmValue=" + rhythmValue);
        // midi.noteOn = function(channel, note, velocity, delay)
        MIDI.noteOn(0, pitch, velocity, startTime);
        // midi.noteOff = function(channelId, noteId, delay)
        MIDI.noteOff(0, pitch, startTime + rhythmValue);
    };

//    var playNow = function (pitch, velocity, rhythmValue) {
//        playNote(pitch, velocity, 0, rhythmValue);
//    };

</script>
</body>
</html>